{
    // -------------------------------------------------------------
    // 1. 关键设置：告诉插件 PDF 在哪里
    // -------------------------------------------------------------
    // 因为你的 .latexmkrc 设置了 $out_dir = 'output'
    // 必须告诉 VS Code 去这个目录找 PDF，否则预览窗口会报错
    "latex-workshop.latex.outDir": "output",

    // -------------------------------------------------------------
    // 2. 定义工具：创建一个纯净的 latexmk 命令
    // -------------------------------------------------------------
    "latex-workshop.latex.tools": [
        {
            "name": "run_my_latexmkrc",
            "command": "latexmk",
            "args": [
                // 这里的参数越少越好，因为主要的逻辑都在你的 .latexmkrc 里
                // 我们只保留基本的交互模式，方便 VS Code 捕获报错
                "-synctex=1",
                "-interaction=nonstopmode",
                "-file-line-error"
                
                // 注意：绝对不要在这里加 -pdfxe 或 -outdir
                // 你的配置文件里已经写了 $pdf_mode=5 和 $out_dir
                // 再次添加会导致“参数重复”或“被覆盖”
            ],
            "env": {}
        }
    ],

    // -------------------------------------------------------------
    // 3. 定义配方：把上面那个工具变成默认编译方式
    // -------------------------------------------------------------
    "latex-workshop.latex.recipes": [
        {
            "name": "编译 (使用 .latexmkrc)",
            "tools": [
                "run_my_latexmkrc"
            ]
        }
    ],

    // -------------------------------------------------------------
    // 4. 其他辅助设置
    // -------------------------------------------------------------
    // 将上面的配方设为默认（按 Ctrl+S 自动触发这个）
    "latex-workshop.latex.recipe.default": "first",
    
    // 这里的清理设置也可以配合你的 output 目录
    "latex-workshop.latex.clean.subfolder.enabled": true,
    "latex-workshop.latex.autoBuild.run": "onSave"
}